let t=null,i=null,a=!1;const f=3e3;function g(e){return`${e.settings.aliveIntelligenceUrl||""}/api/openclaw/stream`}function m(e){d(e);const o=g(e);try{t=new EventSource(o)}catch{r(e);return}t.addEventListener("cognitive-state",s=>{try{const n=JSON.parse(s.data);if(e.cognitionState={selfState:n.selfState,stateDescription:n.stateDescription,recentEmotions:e.cognitionState?.recentEmotions??[],memoryCount:e.cognitionState?.memoryCount??0,lastInteraction:e.cognitionState?.lastInteraction??null,engineStatuses:n.engineStatuses??[],recentSignals:n.recentSignals??[],innerLifeStream:e.cognitionState?.innerLifeStream??[],tick:n.tick},e.cognitionLoading=!1,n.selfState){const u=220+(n.selfState.valence??0)*30,S=20+(n.selfState.arousal??.3)*30,l=document.querySelector("openclaw-app");l instanceof HTMLElement&&(l.style.setProperty("--mood-hue",String(Math.round(u))),l.style.setProperty("--mood-saturation",`${Math.round(S)}%`))}}catch{}}),t.addEventListener("keepalive",()=>{}),t.addEventListener("open",()=>{c(e)}),t.addEventListener("error",()=>{t&&(t.close(),t=null),r(e),i=window.setTimeout(()=>{i=null,m(e)},f)})}function d(e){t&&(t.close(),t=null),i!=null&&(window.clearTimeout(i),i=null),c(e)}function r(e){a||(a=!0,e.startCognitionPolling())}function c(e){a&&(a=!1,e.stopCognitionPolling())}export{m as startAliveStream,d as stopAliveStream};
//# sourceMappingURL=app-alive-stream-C8610wcI.js.map
